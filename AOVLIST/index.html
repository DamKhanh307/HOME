<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <link rel="shortcut icon" href="../elaina_symbol.png" type="image/x-icon">
    <title>AOV List ID</title>
</head>

<body>
    <div class="Mode">
        <img src="https://images7.alphacoders.com/121/thumb-1920-1211134.jpg" alt="Background" class='bgmode'>
        <div class="container_mode">
            <div class="choice">
                <img src="heroid.png" alt="Hero ID" class="cover">
                <a href="https://vande541.github.io/aov-id/" class="hero">Hero ID</a>
            </div>
            <div class="choice">
                <img src="skinid.png" alt="Skin ID" class="cover">
                <a href="" class="skin">Skin ID</a>
            </div>
        </div>
    </div>
    <div class="container" style="display:none">
        <h1 class="title">AOV LIST HERO SKIN</h1>
        <input type="text" id="search" class="search-input" placeholder="Nhập ID Hoặc Tên Skin...">
        <ul id="results" class="results-list"></ul>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            var skin = document.querySelector(".skin");
            var Mode = document.querySelector('.Mode');
            var con = document.querySelector(".container")

            skin.addEventListener('click', function (e) {
                e.preventDefault();
                Mode.remove();
                con.style.display = 'block';
            });
        });

        let allEntries = new Map();

        async function loadData() {
            try {
                const response = await fetch('./database.txt');
                const data = await response.text();

                const entries = data.split('\n');

                entries.forEach(entry => {
                    const parts = entry.split(',').map(part => part.trim());
                    const idPart = parts.find(part => part.startsWith('Decimal_ID:'));
                    if (idPart) {
                        const id = idPart.split(':')[1].trim();
                        allEntries.set(id, entry.trim());
                    }
                });
            } catch (error) {
                console.error('Error loading data:', error);
            }
        }

        // Debounce function to limit the rate at which the search function is invoked
        function debounce(func, wait) {
            let timeout;
            return function (...args) {
                clearTimeout(timeout);
                timeout = setTimeout(() => func.apply(this, args), wait);
            };
        }

        function searchID() {
            const searchTerm = document.getElementById('search').value.trim().toLowerCase();
            const resultsList = document.getElementById('results');
            resultsList.innerHTML = ''; // Clear previous results

            if (searchTerm === '') {
                return; // If search term is empty, do nothing
            }

            allEntries.forEach((entry, id) => {
                if (id.toLowerCase().startsWith(searchTerm)) { // Kiểm tra xem ID có bắt đầu bằng searchTerm không
                    const listItem = document.createElement('li');
                    listItem.textContent = entry;
                    resultsList.appendChild(listItem);
                }
            });
        }

        // Use DOMContentLoaded to ensure HTML is fully loaded before executing JavaScript
        document.addEventListener('DOMContentLoaded', () => {
            loadData(); // Load data when the DOM is fully loaded

            const searchInput = document.getElementById('search');
            const debouncedSearch = debounce(searchID, 300);
            searchInput.addEventListener('input', debouncedSearch);
        });

        document.addEventListener('DOMContentLoaded', () => {
            const resultsList = document.getElementById('results');
            resultsList.addEventListener('scroll', handleScroll);

            function handleScroll() {
                const scrollTop = resultsList.scrollTop;
                const clientHeight = resultsList.clientHeight;

                const shrinkRatio = scrollTop / clientHeight;

                const h1 = document.querySelector('.title');
                const input = document.querySelector('.search-input');

                // Set constraints
                const minFontSize = 3;
                const minInputHeight = 2;
                const minTopPercentage = 35;

                h1.style.fontSize = `${Math.max(5 - shrinkRatio * 2, minFontSize)}em`;
                input.style.height = `${Math.max(3 - shrinkRatio * 1.5, minInputHeight)}em`;

                input.style.top = `${Math.max(50 - shrinkRatio * 15, minTopPercentage)}%`;
                resultsList.style.top = `${Math.max(65 - shrinkRatio * 15, minTopPercentage + 15)}%`;
            }
        });
    </script>
</body>

</html>